============================================
OOD Inference Runner - All Feature Sets
============================================
Models: gru, tcn, patchtst
Regions: Toronto, Ottawa
Feature Sets: F0, F1, F2, F3
Fold: 0
============================================


========================================
Progress: 1/24
Feature Set: F0
========================================
==========================================
Running gru inference for Toronto - F0
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
==========================================
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/gru_ood_inference.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Toronto
Feature set: F0, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
Found 11 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/gru_single_train/Toronto/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F0/97/fold_0/best_model.pth

Processing window 1/11: 2024-01-20 13:00:00 to 2024-01-21 12:00:00
  MAE: 33745.4104, RMSE: 43710.7394, MAPE: 4.39%, SMAPE: 4.34%

Processing window 2/11: 2024-01-17 10:00:00 to 2024-01-18 09:00:00
  MAE: 24338.6509, RMSE: 28752.9039, MAPE: 3.42%, SMAPE: 3.49%

Processing window 3/11: 2024-01-15 09:00:00 to 2024-01-16 08:00:00
  MAE: 32750.9170, RMSE: 39272.1688, MAPE: 4.94%, SMAPE: 4.92%

Processing window 4/11: 2024-01-10 02:00:00 to 2024-01-11 01:00:00
  MAE: 23236.6160, RMSE: 29481.3456, MAPE: 4.52%, SMAPE: 4.36%

Processing window 5/11: 2024-01-13 03:00:00 to 2024-01-14 02:00:00
  MAE: 33442.9642, RMSE: 39199.6700, MAPE: 5.61%, SMAPE: 5.56%

Processing window 6/11: 2023-11-09 01:00:00 to 2023-11-10 00:00:00
  MAE: 22037.9468, RMSE: 25687.4795, MAPE: 4.18%, SMAPE: 4.09%

Processing window 7/11: 2023-12-10 03:00:00 to 2023-12-11 02:00:00
  MAE: 37737.4707, RMSE: 41387.6965, MAPE: 6.95%, SMAPE: 6.91%

Processing window 8/11: 2023-10-06 01:00:00 to 2023-10-07 00:00:00
  MAE: 26382.3073, RMSE: 30986.0360, MAPE: 5.16%, SMAPE: 5.21%

Processing window 9/11: 2024-01-26 05:00:00 to 2024-01-27 04:00:00
  MAE: 14111.3912, RMSE: 20092.7450, MAPE: 2.29%, SMAPE: 2.26%

Processing window 10/11: 2024-03-09 08:00:00 to 2024-03-10 07:00:00
  MAE: 29465.2230, RMSE: 34931.0476, MAPE: 5.04%, SMAPE: 4.96%

Processing window 11/11: 2024-02-24 04:00:00 to 2024-02-25 03:00:00
  MAE: 39024.3730, RMSE: 43478.6343, MAPE: 6.32%, SMAPE: 6.50%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 11

Average metrics across all OOD windows:
  MAE:   28752.1155 ± 7514.2407
  RMSE:  34270.9515 ± 7830.4318
  MAPE:  4.80% ± 1.29%
  SMAPE: 4.78% ± 1.31%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Toronto_F0_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Toronto_F0_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Toronto_F0_fold0_summary.txt

✓ gru Toronto F0 completed successfully

========================================
Progress: 2/24
Feature Set: F0
========================================
==========================================
Running tcn inference for Toronto - F0
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:143: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/tcn_ood_inference.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Toronto
Feature set: F0, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
Found 11 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/tcn_single_train/Toronto/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F0/97/fold_0/best_model.pth

Processing window 1/11: 2024-01-20 13:00:00 to 2024-01-21 12:00:00
  MAE: 19733.9747, RMSE: 22337.8375, MAPE: 2.68%, SMAPE: 2.71%

Processing window 2/11: 2024-01-17 10:00:00 to 2024-01-18 09:00:00
  MAE: 21692.1499, RMSE: 24678.3858, MAPE: 2.97%, SMAPE: 3.01%

Processing window 3/11: 2024-01-15 09:00:00 to 2024-01-16 08:00:00
  MAE: 27211.3999, RMSE: 31027.1731, MAPE: 3.90%, SMAPE: 4.00%

Processing window 4/11: 2024-01-10 02:00:00 to 2024-01-11 01:00:00
  MAE: 27328.0565, RMSE: 33877.2637, MAPE: 4.62%, SMAPE: 4.68%

Processing window 5/11: 2024-01-13 03:00:00 to 2024-01-14 02:00:00
  MAE: 39980.9226, RMSE: 43062.8290, MAPE: 6.26%, SMAPE: 6.30%

Processing window 6/11: 2023-11-09 01:00:00 to 2023-11-10 00:00:00
  MAE: 18852.9838, RMSE: 23470.7924, MAPE: 3.61%, SMAPE: 3.54%

Processing window 7/11: 2023-12-10 03:00:00 to 2023-12-11 02:00:00
  MAE: 39732.8676, RMSE: 44076.1261, MAPE: 7.29%, SMAPE: 7.20%

Processing window 8/11: 2023-10-06 01:00:00 to 2023-10-07 00:00:00
  MAE: 24370.2547, RMSE: 32009.5608, MAPE: 4.72%, SMAPE: 4.86%

Processing window 9/11: 2024-01-26 05:00:00 to 2024-01-27 04:00:00
  MAE: 14697.0051, RMSE: 18777.3332, MAPE: 2.60%, SMAPE: 2.57%

Processing window 10/11: 2024-03-09 08:00:00 to 2024-03-10 07:00:00
  MAE: 16875.3635, RMSE: 24146.7340, MAPE: 2.90%, SMAPE: 2.94%

Processing window 11/11: 2024-02-24 04:00:00 to 2024-02-25 03:00:00
  MAE: 15242.4869, RMSE: 23171.1158, MAPE: 2.25%, SMAPE: 2.20%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 11

Average metrics across all OOD windows:
  MAE:   24156.1332 ± 8877.9959
  RMSE:  29148.6501 ± 8470.1249
  MAPE:  3.98% ± 1.62%
  SMAPE: 4.00% ± 1.61%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Toronto_F0_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Toronto_F0_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Toronto_F0_fold0_summary.txt

✓ tcn Toronto F0 completed successfully

========================================
Progress: 3/24
Feature Set: F0
========================================
==========================================
Running patchtst inference for Toronto - F0
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/patchtst_ood_inference.py:100: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Toronto
Feature set: F0, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
Found 11 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/patchtst_single_train/Toronto/dm64_nh4_nl3_pl16_ps8_inlen168_h24_scalerstandard/overlap/stride1/mean/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F0/597/fold_0/best_model.pth

Processing window 1/11: 2024-01-20 13:00:00 to 2024-01-21 12:00:00
  MAE: 56519.9067, RMSE: 58910.5452, MAPE: 7.91%, SMAPE: 8.29%

Processing window 2/11: 2024-01-17 10:00:00 to 2024-01-18 09:00:00
  MAE: 35666.3973, RMSE: 43385.4584, MAPE: 5.36%, SMAPE: 5.59%

Processing window 3/11: 2024-01-15 09:00:00 to 2024-01-16 08:00:00
  MAE: 37200.8281, RMSE: 46571.2872, MAPE: 5.74%, SMAPE: 5.85%

Processing window 4/11: 2024-01-10 02:00:00 to 2024-01-11 01:00:00
  MAE: 21065.2531, RMSE: 23476.0124, MAPE: 3.80%, SMAPE: 3.79%

Processing window 5/11: 2024-01-13 03:00:00 to 2024-01-14 02:00:00
  MAE: 51572.1630, RMSE: 60483.2689, MAPE: 7.64%, SMAPE: 8.04%

Processing window 6/11: 2023-11-09 01:00:00 to 2023-11-10 00:00:00
  MAE: 25052.5348, RMSE: 29831.4024, MAPE: 5.01%, SMAPE: 5.12%

Processing window 7/11: 2023-12-10 03:00:00 to 2023-12-11 02:00:00
  MAE: 45418.0232, RMSE: 51126.9412, MAPE: 7.69%, SMAPE: 7.99%

Processing window 8/11: 2023-10-06 01:00:00 to 2023-10-07 00:00:00
  MAE: 75521.8168, RMSE: 82072.3201, MAPE: 15.46%, SMAPE: 17.02%

Processing window 9/11: 2024-01-26 05:00:00 to 2024-01-27 04:00:00
  MAE: 47590.6304, RMSE: 51857.5645, MAPE: 8.35%, SMAPE: 8.81%

Processing window 10/11: 2024-03-09 08:00:00 to 2024-03-10 07:00:00
  MAE: 75642.4099, RMSE: 79732.6468, MAPE: 14.13%, SMAPE: 15.46%

Processing window 11/11: 2024-02-24 04:00:00 to 2024-02-25 03:00:00
  MAE: 98605.1363, RMSE: 105003.8966, MAPE: 15.06%, SMAPE: 16.52%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 11

Average metrics across all OOD windows:
  MAE:   51805.0091 ± 23529.0543
  RMSE:  57495.5767 ± 23832.5241
  MAPE:  8.74% ± 4.19%
  SMAPE: 9.32% ± 4.77%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Toronto_F0_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Toronto_F0_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Toronto_F0_fold0_summary.txt

✓ patchtst Toronto F0 completed successfully

========================================
Progress: 4/24
Feature Set: F0
========================================
==========================================
Running gru inference for Ottawa - F0
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
==========================================
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/gru_ood_inference.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Ottawa
Feature set: F0, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
Found 13 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/gru_single_train/Ottawa/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F0/97/fold_0/best_model.pth

Processing window 1/13: 2024-01-19 03:00:00 to 2024-01-20 02:00:00
  MAE: 67485.9796, RMSE: 86756.2966, MAPE: 18.18%, SMAPE: 15.95%

Processing window 2/13: 2024-01-10 01:00:00 to 2024-01-11 00:00:00
  MAE: 94811.4381, RMSE: 115527.3795, MAPE: 29.53%, SMAPE: 24.33%

Processing window 3/13: 2023-12-04 03:00:00 to 2023-12-05 02:00:00
  MAE: 77295.4715, RMSE: 93065.5539, MAPE: 23.75%, SMAPE: 20.50%

Processing window 4/13: 2023-11-22 01:00:00 to 2023-11-23 00:00:00
  MAE: 74641.5065, RMSE: 87411.6175, MAPE: 24.29%, SMAPE: 21.26%

Processing window 5/13: 2024-03-09 23:00:00 to 2024-03-10 22:00:00
  MAE: 56463.5384, RMSE: 62601.0697, MAPE: 17.39%, SMAPE: 15.86%

Processing window 6/13: 2023-12-18 09:00:00 to 2023-12-19 08:00:00
  MAE: 77524.5593, RMSE: 96204.4103, MAPE: 24.69%, SMAPE: 20.88%

Processing window 7/13: 2023-10-07 03:00:00 to 2023-10-08 02:00:00
  MAE: 54883.2850, RMSE: 63204.5783, MAPE: 20.56%, SMAPE: 18.19%

Processing window 8/13: 2024-01-13 02:00:00 to 2024-01-14 01:00:00
  MAE: 64179.2200, RMSE: 76565.2239, MAPE: 17.06%, SMAPE: 15.33%

Processing window 9/13: 2024-02-19 09:00:00 to 2024-02-20 08:00:00
  MAE: 101275.1794, RMSE: 118496.1867, MAPE: 27.57%, SMAPE: 23.41%

Processing window 10/13: 2024-01-21 03:00:00 to 2024-01-22 02:00:00
  MAE: 64660.3469, RMSE: 79519.8128, MAPE: 15.78%, SMAPE: 14.21%

Processing window 11/13: 2023-12-10 07:00:00 to 2023-12-11 06:00:00
  MAE: 75655.8889, RMSE: 83248.3026, MAPE: 22.39%, SMAPE: 19.92%

Processing window 12/13: 2023-10-09 07:00:00 to 2023-10-10 06:00:00
  MAE: 45844.9758, RMSE: 48027.3141, MAPE: 16.80%, SMAPE: 15.40%

Processing window 13/13: 2024-02-23 19:00:00 to 2024-02-24 18:00:00
  MAE: 35276.5334, RMSE: 42718.0733, MAPE: 10.91%, SMAPE: 11.74%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 13

Average metrics across all OOD windows:
  MAE:   68461.3787 ± 18248.2719
  RMSE:  81026.6015 ± 22883.5911
  MAPE:  20.68% ± 5.26%
  SMAPE: 18.23% ± 3.80%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Ottawa_F0_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Ottawa_F0_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Ottawa_F0_fold0_summary.txt

✓ gru Ottawa F0 completed successfully

========================================
Progress: 5/24
Feature Set: F0
========================================
==========================================
Running tcn inference for Ottawa - F0
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:143: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/tcn_ood_inference.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Ottawa
Feature set: F0, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
Found 13 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/tcn_single_train/Ottawa/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F0/97/fold_0/best_model.pth

Processing window 1/13: 2024-01-19 03:00:00 to 2024-01-20 02:00:00
  MAE: 20565.3403, RMSE: 27257.9674, MAPE: 5.44%, SMAPE: 5.68%

Processing window 2/13: 2024-01-10 01:00:00 to 2024-01-11 00:00:00
  MAE: 19624.3097, RMSE: 23655.2672, MAPE: 6.95%, SMAPE: 6.63%

Processing window 3/13: 2023-12-04 03:00:00 to 2023-12-05 02:00:00
  MAE: 16648.5575, RMSE: 20800.2340, MAPE: 5.39%, SMAPE: 5.37%

Processing window 4/13: 2023-11-22 01:00:00 to 2023-11-23 00:00:00
  MAE: 10954.5716, RMSE: 13440.3342, MAPE: 3.90%, SMAPE: 3.87%

Processing window 5/13: 2024-03-09 23:00:00 to 2024-03-10 22:00:00
  MAE: 33115.5028, RMSE: 39438.7739, MAPE: 10.23%, SMAPE: 10.53%

Processing window 6/13: 2023-12-18 09:00:00 to 2023-12-19 08:00:00
  MAE: 33026.8695, RMSE: 40530.8396, MAPE: 11.13%, SMAPE: 10.30%

Processing window 7/13: 2023-10-07 03:00:00 to 2023-10-08 02:00:00
  MAE: 19487.4840, RMSE: 22563.1007, MAPE: 7.90%, SMAPE: 7.50%

Processing window 8/13: 2024-01-13 02:00:00 to 2024-01-14 01:00:00
  MAE: 15415.0219, RMSE: 17921.6604, MAPE: 4.42%, SMAPE: 4.40%

Processing window 9/13: 2024-02-19 09:00:00 to 2024-02-20 08:00:00
  MAE: 31083.6361, RMSE: 37322.7768, MAPE: 8.13%, SMAPE: 8.25%

Processing window 10/13: 2024-01-21 03:00:00 to 2024-01-22 02:00:00
  MAE: 23681.8458, RMSE: 34368.7712, MAPE: 5.28%, SMAPE: 5.55%

Processing window 11/13: 2023-12-10 07:00:00 to 2023-12-11 06:00:00
  MAE: 22721.7691, RMSE: 27170.2023, MAPE: 6.71%, SMAPE: 6.89%

Processing window 12/13: 2023-10-09 07:00:00 to 2023-10-10 06:00:00
  MAE: 17731.3483, RMSE: 20466.0185, MAPE: 6.73%, SMAPE: 6.46%

Processing window 13/13: 2024-02-23 19:00:00 to 2024-02-24 18:00:00
  MAE: 41970.7362, RMSE: 48762.6171, MAPE: 11.82%, SMAPE: 12.79%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 13

Average metrics across all OOD windows:
  MAE:   23540.5379 ± 8780.7738
  RMSE:  28746.0433 ± 10452.3669
  MAPE:  7.23% ± 2.53%
  SMAPE: 7.25% ± 2.60%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Ottawa_F0_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Ottawa_F0_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Ottawa_F0_fold0_summary.txt

✓ tcn Ottawa F0 completed successfully

========================================
Progress: 6/24
Feature Set: F0
========================================
==========================================
Running patchtst inference for Ottawa - F0
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/patchtst_ood_inference.py:100: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Ottawa
Feature set: F0, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
Found 13 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/patchtst_single_train/Ottawa/dm64_nh4_nl3_pl16_ps8_inlen168_h24_scalerstandard/overlap/stride1/mean/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F0/597/fold_0/best_model.pth

Processing window 1/13: 2024-01-19 03:00:00 to 2024-01-20 02:00:00
  MAE: 30220.4969, RMSE: 32890.8430, MAPE: 8.25%, SMAPE: 8.67%

Processing window 2/13: 2024-01-10 01:00:00 to 2024-01-11 00:00:00
  MAE: 11876.3845, RMSE: 13903.5874, MAPE: 3.92%, SMAPE: 3.83%

Processing window 3/13: 2023-12-04 03:00:00 to 2023-12-05 02:00:00
  MAE: 13958.0773, RMSE: 16944.7572, MAPE: 4.65%, SMAPE: 4.73%

Processing window 4/13: 2023-11-22 01:00:00 to 2023-11-23 00:00:00
  MAE: 14651.7326, RMSE: 16661.8644, MAPE: 5.19%, SMAPE: 5.28%

Processing window 5/13: 2024-03-09 23:00:00 to 2024-03-10 22:00:00
  MAE: 11066.6098, RMSE: 14401.8727, MAPE: 3.52%, SMAPE: 3.54%

Processing window 6/13: 2023-12-18 09:00:00 to 2023-12-19 08:00:00
  MAE: 9519.0943, RMSE: 11266.5600, MAPE: 3.10%, SMAPE: 3.12%

Processing window 7/13: 2023-10-07 03:00:00 to 2023-10-08 02:00:00
  MAE: 7863.1386, RMSE: 9468.6822, MAPE: 3.16%, SMAPE: 3.20%

Processing window 8/13: 2024-01-13 02:00:00 to 2024-01-14 01:00:00
  MAE: 7043.5391, RMSE: 10401.0379, MAPE: 2.19%, SMAPE: 2.17%

Processing window 9/13: 2024-02-19 09:00:00 to 2024-02-20 08:00:00
  MAE: 19699.9551, RMSE: 23963.8546, MAPE: 6.15%, SMAPE: 6.47%

Processing window 10/13: 2024-01-21 03:00:00 to 2024-01-22 02:00:00
  MAE: 11864.9818, RMSE: 14774.2926, MAPE: 3.31%, SMAPE: 3.40%

Processing window 11/13: 2023-12-10 07:00:00 to 2023-12-11 06:00:00
  MAE: 9346.3451, RMSE: 11261.0367, MAPE: 3.33%, SMAPE: 3.39%

Processing window 12/13: 2023-10-09 07:00:00 to 2023-10-10 06:00:00
  MAE: 31532.7821, RMSE: 39033.6436, MAPE: 10.25%, SMAPE: 9.84%

Processing window 13/13: 2024-02-23 19:00:00 to 2024-02-24 18:00:00
  MAE: 42844.3164, RMSE: 45459.5493, MAPE: 12.56%, SMAPE: 13.52%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 13

Average metrics across all OOD windows:
  MAE:   17037.4964 ± 11033.7808
  RMSE:  20033.1986 ± 11776.8205
  MAPE:  5.35% ± 3.15%
  SMAPE: 5.47% ± 3.32%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Ottawa_F0_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Ottawa_F0_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Ottawa_F0_fold0_summary.txt

✓ patchtst Ottawa F0 completed successfully

========================================
Progress: 7/24
Feature Set: F1
========================================
==========================================
Running gru inference for Toronto - F1
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
==========================================
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/gru_ood_inference.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Toronto
Feature set: F1, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
Found 11 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/gru_single_train/Toronto/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F1/97/fold_0/best_model.pth

Processing window 1/11: 2024-01-20 13:00:00 to 2024-01-21 12:00:00
  MAE: 24919.9352, RMSE: 32500.1068, MAPE: 3.33%, SMAPE: 3.36%

Processing window 2/11: 2024-01-17 10:00:00 to 2024-01-18 09:00:00
  MAE: 20746.4655, RMSE: 25798.6251, MAPE: 3.11%, SMAPE: 3.15%

Processing window 3/11: 2024-01-15 09:00:00 to 2024-01-16 08:00:00
  MAE: 32619.3522, RMSE: 40565.4830, MAPE: 5.02%, SMAPE: 5.17%

Processing window 4/11: 2024-01-10 02:00:00 to 2024-01-11 01:00:00
  MAE: 22653.5727, RMSE: 26693.2758, MAPE: 3.93%, SMAPE: 3.96%

Processing window 5/11: 2024-01-13 03:00:00 to 2024-01-14 02:00:00
  MAE: 43930.6473, RMSE: 53956.2236, MAPE: 6.56%, SMAPE: 6.89%

Processing window 6/11: 2023-11-09 01:00:00 to 2023-11-10 00:00:00
  MAE: 20355.1534, RMSE: 24156.2678, MAPE: 4.02%, SMAPE: 3.96%

Processing window 7/11: 2023-12-10 03:00:00 to 2023-12-11 02:00:00
  MAE: 38620.0325, RMSE: 43008.6002, MAPE: 6.67%, SMAPE: 6.85%

Processing window 8/11: 2023-10-06 01:00:00 to 2023-10-07 00:00:00
  MAE: 25843.5118, RMSE: 31110.1343, MAPE: 5.10%, SMAPE: 5.16%

Processing window 9/11: 2024-01-26 05:00:00 to 2024-01-27 04:00:00
  MAE: 17371.7206, RMSE: 23420.1024, MAPE: 2.82%, SMAPE: 2.80%

Processing window 10/11: 2024-03-09 08:00:00 to 2024-03-10 07:00:00
  MAE: 32135.1073, RMSE: 40514.3190, MAPE: 5.66%, SMAPE: 5.61%

Processing window 11/11: 2024-02-24 04:00:00 to 2024-02-25 03:00:00
  MAE: 41782.7459, RMSE: 47460.4251, MAPE: 6.90%, SMAPE: 7.16%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 11

Average metrics across all OOD windows:
  MAE:   29179.8404 ± 9199.9960
  RMSE:  35380.3239 ± 10321.1314
  MAPE:  4.83% ± 1.49%
  SMAPE: 4.91% ± 1.58%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Toronto_F1_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Toronto_F1_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Toronto_F1_fold0_summary.txt

✓ gru Toronto F1 completed successfully

========================================
Progress: 8/24
Feature Set: F1
========================================
==========================================
Running tcn inference for Toronto - F1
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:143: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/tcn_ood_inference.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Toronto
Feature set: F1, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
Found 11 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/tcn_single_train/Toronto/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F1/97/fold_0/best_model.pth

Processing window 1/11: 2024-01-20 13:00:00 to 2024-01-21 12:00:00
  MAE: 19976.7645, RMSE: 23902.6817, MAPE: 2.63%, SMAPE: 2.67%

Processing window 2/11: 2024-01-17 10:00:00 to 2024-01-18 09:00:00
  MAE: 42834.9128, RMSE: 45617.4049, MAPE: 6.08%, SMAPE: 6.30%

Processing window 3/11: 2024-01-15 09:00:00 to 2024-01-16 08:00:00
  MAE: 26750.4880, RMSE: 30412.4143, MAPE: 3.90%, SMAPE: 4.00%

Processing window 4/11: 2024-01-10 02:00:00 to 2024-01-11 01:00:00
  MAE: 24566.5555, RMSE: 32508.5575, MAPE: 3.93%, SMAPE: 4.04%

Processing window 5/11: 2024-01-13 03:00:00 to 2024-01-14 02:00:00
  MAE: 46372.5094, RMSE: 53229.0089, MAPE: 6.74%, SMAPE: 7.04%

Processing window 6/11: 2023-11-09 01:00:00 to 2023-11-10 00:00:00
  MAE: 24912.3922, RMSE: 31119.0644, MAPE: 4.56%, SMAPE: 4.42%

Processing window 7/11: 2023-12-10 03:00:00 to 2023-12-11 02:00:00
  MAE: 36362.8104, RMSE: 40186.2797, MAPE: 6.38%, SMAPE: 6.41%

Processing window 8/11: 2023-10-06 01:00:00 to 2023-10-07 00:00:00
  MAE: 43613.8322, RMSE: 49498.2853, MAPE: 8.67%, SMAPE: 9.11%

Processing window 9/11: 2024-01-26 05:00:00 to 2024-01-27 04:00:00
  MAE: 18511.0971, RMSE: 22441.9436, MAPE: 3.08%, SMAPE: 3.05%

Processing window 10/11: 2024-03-09 08:00:00 to 2024-03-10 07:00:00
  MAE: 11953.2347, RMSE: 16659.7800, MAPE: 2.06%, SMAPE: 2.07%

Processing window 11/11: 2024-02-24 04:00:00 to 2024-02-25 03:00:00
  MAE: 19070.7049, RMSE: 22463.4262, MAPE: 3.02%, SMAPE: 3.08%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 11

Average metrics across all OOD windows:
  MAE:   28629.5729 ± 11753.7987
  RMSE:  33458.0770 ± 12135.3637
  MAPE:  4.64% ± 2.06%
  SMAPE: 4.75% ± 2.19%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Toronto_F1_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Toronto_F1_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Toronto_F1_fold0_summary.txt

✓ tcn Toronto F1 completed successfully

========================================
Progress: 9/24
Feature Set: F1
========================================
==========================================
Running patchtst inference for Toronto - F1
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/patchtst_ood_inference.py:100: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Toronto
Feature set: F1, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
Found 11 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/patchtst_single_train/Toronto/dm64_nh4_nl3_pl16_ps8_inlen168_h24_scalerstandard/overlap/stride1/mean/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F1/597/fold_0/best_model.pth

Processing window 1/11: 2024-01-20 13:00:00 to 2024-01-21 12:00:00
  MAE: 65553.8684, RMSE: 72514.3287, MAPE: 9.54%, SMAPE: 10.20%

Processing window 2/11: 2024-01-17 10:00:00 to 2024-01-18 09:00:00
  MAE: 108126.6524, RMSE: 118951.0315, MAPE: 16.09%, SMAPE: 18.00%

Processing window 3/11: 2024-01-15 09:00:00 to 2024-01-16 08:00:00
  MAE: 70199.9832, RMSE: 93140.0514, MAPE: 10.98%, SMAPE: 12.27%

Processing window 4/11: 2024-01-10 02:00:00 to 2024-01-11 01:00:00
  MAE: 54850.7699, RMSE: 65081.1105, MAPE: 8.94%, SMAPE: 9.60%

Processing window 5/11: 2024-01-13 03:00:00 to 2024-01-14 02:00:00
  MAE: 85205.4252, RMSE: 100954.1552, MAPE: 12.41%, SMAPE: 13.69%

Processing window 6/11: 2023-11-09 01:00:00 to 2023-11-10 00:00:00
  MAE: 69847.5166, RMSE: 81767.7090, MAPE: 12.89%, SMAPE: 14.16%

Processing window 7/11: 2023-12-10 03:00:00 to 2023-12-11 02:00:00
  MAE: 80593.7988, RMSE: 94553.6256, MAPE: 13.10%, SMAPE: 14.50%

Processing window 8/11: 2023-10-06 01:00:00 to 2023-10-07 00:00:00
  MAE: 134722.2347, RMSE: 147759.9853, MAPE: 25.32%, SMAPE: 22.17%

Processing window 9/11: 2024-01-26 05:00:00 to 2024-01-27 04:00:00
  MAE: 44941.6522, RMSE: 48571.9230, MAPE: 8.10%, SMAPE: 8.56%

Processing window 10/11: 2024-03-09 08:00:00 to 2024-03-10 07:00:00
  MAE: 109961.9387, RMSE: 115231.2320, MAPE: 20.58%, SMAPE: 23.52%

Processing window 11/11: 2024-02-24 04:00:00 to 2024-02-25 03:00:00
  MAE: 101921.2875, RMSE: 109243.6241, MAPE: 15.85%, SMAPE: 17.59%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 11

Average metrics across all OOD windows:
  MAE:   84175.0116 ± 26961.0437
  RMSE:  95251.7069 ± 27819.5443
  MAPE:  13.98% ± 5.23%
  SMAPE: 14.93% ± 4.93%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Toronto_F1_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Toronto_F1_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Toronto_F1_fold0_summary.txt

✓ patchtst Toronto F1 completed successfully

========================================
Progress: 10/24
Feature Set: F1
========================================
==========================================
Running gru inference for Ottawa - F1
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
==========================================
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/gru_ood_inference.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Ottawa
Feature set: F1, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
Found 13 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/gru_single_train/Ottawa/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F1/97/fold_0/best_model.pth

Processing window 1/13: 2024-01-19 03:00:00 to 2024-01-20 02:00:00
  MAE: 41767.4106, RMSE: 48026.8707, MAPE: 12.21%, SMAPE: 12.18%

Processing window 2/13: 2024-01-10 01:00:00 to 2024-01-11 00:00:00
  MAE: 32899.4474, RMSE: 41400.1122, MAPE: 10.43%, SMAPE: 9.74%

Processing window 3/13: 2023-12-04 03:00:00 to 2023-12-05 02:00:00
  MAE: 27437.2911, RMSE: 36195.1093, MAPE: 8.54%, SMAPE: 8.04%

Processing window 4/13: 2023-11-22 01:00:00 to 2023-11-23 00:00:00
  MAE: 28659.8652, RMSE: 37015.1578, MAPE: 9.25%, SMAPE: 8.68%

Processing window 5/13: 2024-03-09 23:00:00 to 2024-03-10 22:00:00
  MAE: 16775.3990, RMSE: 20933.3945, MAPE: 5.45%, SMAPE: 5.37%

Processing window 6/13: 2023-12-18 09:00:00 to 2023-12-19 08:00:00
  MAE: 45361.9979, RMSE: 54491.7207, MAPE: 14.34%, SMAPE: 13.20%

Processing window 7/13: 2023-10-07 03:00:00 to 2023-10-08 02:00:00
  MAE: 32176.7631, RMSE: 40711.8363, MAPE: 11.73%, SMAPE: 10.80%

Processing window 8/13: 2024-01-13 02:00:00 to 2024-01-14 01:00:00
  MAE: 30710.6360, RMSE: 36478.3188, MAPE: 8.53%, SMAPE: 8.34%

Processing window 9/13: 2024-02-19 09:00:00 to 2024-02-20 08:00:00
  MAE: 58539.2150, RMSE: 75418.1474, MAPE: 15.61%, SMAPE: 13.99%

Processing window 10/13: 2024-01-21 03:00:00 to 2024-01-22 02:00:00
  MAE: 23662.5310, RMSE: 30000.9757, MAPE: 6.53%, SMAPE: 6.60%

Processing window 11/13: 2023-12-10 07:00:00 to 2023-12-11 06:00:00
  MAE: 37691.9007, RMSE: 46821.5394, MAPE: 10.49%, SMAPE: 9.78%

Processing window 12/13: 2023-10-09 07:00:00 to 2023-10-10 06:00:00
  MAE: 10002.9910, RMSE: 12623.3211, MAPE: 3.44%, SMAPE: 3.42%

Processing window 13/13: 2024-02-23 19:00:00 to 2024-02-24 18:00:00
  MAE: 43110.6008, RMSE: 49766.2188, MAPE: 13.70%, SMAPE: 15.06%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 13

Average metrics across all OOD windows:
  MAE:   32984.3114 ± 12718.6573
  RMSE:  40760.2094 ± 15584.5530
  MAPE:  10.02% ± 3.57%
  SMAPE: 9.63% ± 3.42%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Ottawa_F1_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Ottawa_F1_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Ottawa_F1_fold0_summary.txt

✓ gru Ottawa F1 completed successfully

========================================
Progress: 11/24
Feature Set: F1
========================================
==========================================
Running tcn inference for Ottawa - F1
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:143: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/tcn_ood_inference.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Ottawa
Feature set: F1, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
Found 13 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/tcn_single_train/Ottawa/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F1/97/fold_0/best_model.pth

Processing window 1/13: 2024-01-19 03:00:00 to 2024-01-20 02:00:00
  MAE: 31295.9622, RMSE: 36212.3641, MAPE: 8.43%, SMAPE: 8.67%

Processing window 2/13: 2024-01-10 01:00:00 to 2024-01-11 00:00:00
  MAE: 16247.2513, RMSE: 19211.6968, MAPE: 5.58%, SMAPE: 5.43%

Processing window 3/13: 2023-12-04 03:00:00 to 2023-12-05 02:00:00
  MAE: 21230.3488, RMSE: 26422.2910, MAPE: 6.85%, SMAPE: 6.83%

Processing window 4/13: 2023-11-22 01:00:00 to 2023-11-23 00:00:00
  MAE: 15043.1447, RMSE: 18888.6038, MAPE: 5.39%, SMAPE: 5.28%

Processing window 5/13: 2024-03-09 23:00:00 to 2024-03-10 22:00:00
  MAE: 38903.6658, RMSE: 44255.8662, MAPE: 12.30%, SMAPE: 12.62%

Processing window 6/13: 2023-12-18 09:00:00 to 2023-12-19 08:00:00
  MAE: 22117.8452, RMSE: 28871.3467, MAPE: 7.33%, SMAPE: 6.96%

Processing window 7/13: 2023-10-07 03:00:00 to 2023-10-08 02:00:00
  MAE: 20877.2076, RMSE: 26414.4825, MAPE: 9.69%, SMAPE: 9.00%

Processing window 8/13: 2024-01-13 02:00:00 to 2024-01-14 01:00:00
  MAE: 21386.3102, RMSE: 24897.0393, MAPE: 6.23%, SMAPE: 6.24%

Processing window 9/13: 2024-02-19 09:00:00 to 2024-02-20 08:00:00
  MAE: 21713.8346, RMSE: 26556.7878, MAPE: 5.92%, SMAPE: 5.89%

Processing window 10/13: 2024-01-21 03:00:00 to 2024-01-22 02:00:00
  MAE: 36993.5093, RMSE: 48248.5532, MAPE: 8.91%, SMAPE: 9.47%

Processing window 11/13: 2023-12-10 07:00:00 to 2023-12-11 06:00:00
  MAE: 28122.5961, RMSE: 33820.4988, MAPE: 8.53%, SMAPE: 8.71%

Processing window 12/13: 2023-10-09 07:00:00 to 2023-10-10 06:00:00
  MAE: 15524.9213, RMSE: 19779.4862, MAPE: 5.10%, SMAPE: 5.19%

Processing window 13/13: 2024-02-23 19:00:00 to 2024-02-24 18:00:00
  MAE: 40957.1767, RMSE: 44156.4817, MAPE: 11.52%, SMAPE: 12.13%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 13

Average metrics across all OOD windows:
  MAE:   25416.4441 ± 8980.6353
  RMSE:  30595.0383 ± 9976.5032
  MAPE:  7.83% ± 2.33%
  SMAPE: 7.88% ± 2.49%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Ottawa_F1_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Ottawa_F1_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Ottawa_F1_fold0_summary.txt

✓ tcn Ottawa F1 completed successfully

========================================
Progress: 12/24
Feature Set: F1
========================================
==========================================
Running patchtst inference for Ottawa - F1
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/patchtst_ood_inference.py:100: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Ottawa
Feature set: F1, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
Found 13 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/patchtst_single_train/Ottawa/dm64_nh4_nl3_pl16_ps8_inlen168_h24_scalerstandard/overlap/stride1/mean/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F1/597/fold_0/best_model.pth

Processing window 1/13: 2024-01-19 03:00:00 to 2024-01-20 02:00:00
  MAE: 47507.3056, RMSE: 49723.7439, MAPE: 13.14%, SMAPE: 14.15%

Processing window 2/13: 2024-01-10 01:00:00 to 2024-01-11 00:00:00
  MAE: 12174.9132, RMSE: 14210.1725, MAPE: 4.06%, SMAPE: 3.99%

Processing window 3/13: 2023-12-04 03:00:00 to 2023-12-05 02:00:00
  MAE: 18692.3458, RMSE: 21078.4409, MAPE: 6.35%, SMAPE: 6.64%

Processing window 4/13: 2023-11-22 01:00:00 to 2023-11-23 00:00:00
  MAE: 12548.9029, RMSE: 15109.2339, MAPE: 4.48%, SMAPE: 4.46%

Processing window 5/13: 2024-03-09 23:00:00 to 2024-03-10 22:00:00
  MAE: 20547.4951, RMSE: 25842.0915, MAPE: 5.89%, SMAPE: 6.13%

Processing window 6/13: 2023-12-18 09:00:00 to 2023-12-19 08:00:00
  MAE: 20970.5504, RMSE: 23840.0955, MAPE: 7.03%, SMAPE: 7.36%

Processing window 7/13: 2023-10-07 03:00:00 to 2023-10-08 02:00:00
  MAE: 17305.7776, RMSE: 21064.5061, MAPE: 6.83%, SMAPE: 6.90%

Processing window 8/13: 2024-01-13 02:00:00 to 2024-01-14 01:00:00
  MAE: 21214.6288, RMSE: 22967.3131, MAPE: 6.09%, SMAPE: 6.27%

Processing window 9/13: 2024-02-19 09:00:00 to 2024-02-20 08:00:00
  MAE: 35738.4214, RMSE: 41795.3350, MAPE: 10.78%, SMAPE: 11.67%

Processing window 10/13: 2024-01-21 03:00:00 to 2024-01-22 02:00:00
  MAE: 29883.7052, RMSE: 33874.4231, MAPE: 8.00%, SMAPE: 8.46%

Processing window 11/13: 2023-12-10 07:00:00 to 2023-12-11 06:00:00
  MAE: 21215.4808, RMSE: 22823.0354, MAPE: 6.51%, SMAPE: 6.74%

Processing window 12/13: 2023-10-09 07:00:00 to 2023-10-10 06:00:00
  MAE: 69757.2164, RMSE: 72002.2395, MAPE: 27.24%, SMAPE: 32.89%

Processing window 13/13: 2024-02-23 19:00:00 to 2024-02-24 18:00:00
  MAE: 59421.3465, RMSE: 62270.4138, MAPE: 17.36%, SMAPE: 19.22%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 13

Average metrics across all OOD windows:
  MAE:   29767.5454 ± 18306.4432
  RMSE:  32815.4649 ± 18331.1595
  MAPE:  9.52% ± 6.49%
  SMAPE: 10.38% ± 7.98%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Ottawa_F1_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Ottawa_F1_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Ottawa_F1_fold0_summary.txt

✓ patchtst Ottawa F1 completed successfully

========================================
Progress: 13/24
Feature Set: F2
========================================
==========================================
Running gru inference for Toronto - F2
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
==========================================
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/gru_ood_inference.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Toronto
Feature set: F2, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
Found 11 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/gru_single_train/Toronto/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F2/97/fold_0/best_model.pth

Processing window 1/11: 2024-01-20 13:00:00 to 2024-01-21 12:00:00
  MAE: 32046.1973, RMSE: 36639.8884, MAPE: 4.46%, SMAPE: 4.60%

Processing window 2/11: 2024-01-17 10:00:00 to 2024-01-18 09:00:00
  MAE: 20713.1312, RMSE: 24506.2068, MAPE: 3.09%, SMAPE: 3.16%

Processing window 3/11: 2024-01-15 09:00:00 to 2024-01-16 08:00:00
  MAE: 18555.5837, RMSE: 25462.0468, MAPE: 2.88%, SMAPE: 2.95%

Processing window 4/11: 2024-01-10 02:00:00 to 2024-01-11 01:00:00
  MAE: 19367.6759, RMSE: 23591.6339, MAPE: 3.33%, SMAPE: 3.41%

Processing window 5/11: 2024-01-13 03:00:00 to 2024-01-14 02:00:00
  MAE: 41255.9029, RMSE: 48761.1242, MAPE: 6.03%, SMAPE: 6.26%

Processing window 6/11: 2023-11-09 01:00:00 to 2023-11-10 00:00:00
  MAE: 25831.6545, RMSE: 34340.2507, MAPE: 4.81%, SMAPE: 4.71%

Processing window 7/11: 2023-12-10 03:00:00 to 2023-12-11 02:00:00
  MAE: 39905.7935, RMSE: 45816.9621, MAPE: 6.46%, SMAPE: 6.60%

Processing window 8/11: 2023-10-06 01:00:00 to 2023-10-07 00:00:00
  MAE: 21016.8273, RMSE: 26356.2031, MAPE: 4.01%, SMAPE: 4.00%

Processing window 9/11: 2024-01-26 05:00:00 to 2024-01-27 04:00:00
  MAE: 16412.1130, RMSE: 19234.0349, MAPE: 2.80%, SMAPE: 2.78%

Processing window 10/11: 2024-03-09 08:00:00 to 2024-03-10 07:00:00
  MAE: 22038.7738, RMSE: 27026.2218, MAPE: 4.08%, SMAPE: 4.11%

Processing window 11/11: 2024-02-24 04:00:00 to 2024-02-25 03:00:00
  MAE: 47765.0090, RMSE: 52370.9803, MAPE: 7.80%, SMAPE: 8.23%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 11

Average metrics across all OOD windows:
  MAE:   27718.9693 ± 10787.5839
  RMSE:  33100.5048 ± 11356.3500
  MAPE:  4.52% ± 1.63%
  SMAPE: 4.62% ± 1.73%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Toronto_F2_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Toronto_F2_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Toronto_F2_fold0_summary.txt

✓ gru Toronto F2 completed successfully

========================================
Progress: 14/24
Feature Set: F2
========================================
==========================================
Running tcn inference for Toronto - F2
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:143: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/tcn_ood_inference.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Toronto
Feature set: F2, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
Found 11 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/tcn_single_train/Toronto/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F2/97/fold_0/best_model.pth

Processing window 1/11: 2024-01-20 13:00:00 to 2024-01-21 12:00:00
  MAE: 32666.8379, RMSE: 39033.7397, MAPE: 4.49%, SMAPE: 4.64%

Processing window 2/11: 2024-01-17 10:00:00 to 2024-01-18 09:00:00
  MAE: 35944.0159, RMSE: 38270.1429, MAPE: 5.12%, SMAPE: 5.27%

Processing window 3/11: 2024-01-15 09:00:00 to 2024-01-16 08:00:00
  MAE: 25559.1367, RMSE: 30846.3674, MAPE: 3.84%, SMAPE: 3.89%

Processing window 4/11: 2024-01-10 02:00:00 to 2024-01-11 01:00:00
  MAE: 32632.0366, RMSE: 42728.1378, MAPE: 5.08%, SMAPE: 5.30%

Processing window 5/11: 2024-01-13 03:00:00 to 2024-01-14 02:00:00
  MAE: 40176.3821, RMSE: 43541.7920, MAPE: 6.08%, SMAPE: 6.18%

Processing window 6/11: 2023-11-09 01:00:00 to 2023-11-10 00:00:00
  MAE: 32742.6851, RMSE: 38378.7795, MAPE: 6.14%, SMAPE: 5.90%

Processing window 7/11: 2023-12-10 03:00:00 to 2023-12-11 02:00:00
  MAE: 31122.0309, RMSE: 35715.4853, MAPE: 5.27%, SMAPE: 5.28%

Processing window 8/11: 2023-10-06 01:00:00 to 2023-10-07 00:00:00
  MAE: 24130.4888, RMSE: 27938.5963, MAPE: 4.90%, SMAPE: 4.98%

Processing window 9/11: 2024-01-26 05:00:00 to 2024-01-27 04:00:00
  MAE: 16608.6738, RMSE: 18673.3545, MAPE: 2.86%, SMAPE: 2.86%

Processing window 10/11: 2024-03-09 08:00:00 to 2024-03-10 07:00:00
  MAE: 29062.9916, RMSE: 35250.8795, MAPE: 4.92%, SMAPE: 5.09%

Processing window 11/11: 2024-02-24 04:00:00 to 2024-02-25 03:00:00
  MAE: 27765.3973, RMSE: 32600.3476, MAPE: 4.18%, SMAPE: 4.29%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 11

Average metrics across all OOD windows:
  MAE:   29855.5161 ± 6331.2940
  RMSE:  34816.1475 ± 7146.3570
  MAPE:  4.81% ± 0.95%
  SMAPE: 4.88% ± 0.94%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Toronto_F2_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Toronto_F2_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Toronto_F2_fold0_summary.txt

✓ tcn Toronto F2 completed successfully

========================================
Progress: 15/24
Feature Set: F2
========================================
==========================================
Running patchtst inference for Toronto - F2
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/patchtst_ood_inference.py:100: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Toronto
Feature set: F2, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
Found 11 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/patchtst_single_train/Toronto/dm64_nh4_nl3_pl16_ps8_inlen168_h24_scalerstandard/overlap/stride1/mean/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F2/597/fold_0/best_model.pth

Processing window 1/11: 2024-01-20 13:00:00 to 2024-01-21 12:00:00
  MAE: 72497.8734, RMSE: 81464.8765, MAPE: 10.77%, SMAPE: 11.69%

Processing window 2/11: 2024-01-17 10:00:00 to 2024-01-18 09:00:00
  MAE: 72497.2907, RMSE: 84602.5454, MAPE: 11.03%, SMAPE: 12.00%

Processing window 3/11: 2024-01-15 09:00:00 to 2024-01-16 08:00:00
  MAE: 57743.9226, RMSE: 78344.1677, MAPE: 9.25%, SMAPE: 10.14%

Processing window 4/11: 2024-01-10 02:00:00 to 2024-01-11 01:00:00
  MAE: 53040.4907, RMSE: 58867.0247, MAPE: 8.85%, SMAPE: 9.39%

Processing window 5/11: 2024-01-13 03:00:00 to 2024-01-14 02:00:00
  MAE: 49183.7838, RMSE: 57434.2006, MAPE: 7.46%, SMAPE: 7.87%

Processing window 6/11: 2023-11-09 01:00:00 to 2023-11-10 00:00:00
  MAE: 50445.3720, RMSE: 65523.2015, MAPE: 9.65%, SMAPE: 10.56%

Processing window 7/11: 2023-12-10 03:00:00 to 2023-12-11 02:00:00
  MAE: 82221.0626, RMSE: 91945.0077, MAPE: 13.86%, SMAPE: 15.23%

Processing window 8/11: 2023-10-06 01:00:00 to 2023-10-07 00:00:00
  MAE: 31334.9100, RMSE: 39593.5583, MAPE: 5.94%, SMAPE: 5.70%

Processing window 9/11: 2024-01-26 05:00:00 to 2024-01-27 04:00:00
  MAE: 39936.5273, RMSE: 41628.4309, MAPE: 7.00%, SMAPE: 7.30%

Processing window 10/11: 2024-03-09 08:00:00 to 2024-03-10 07:00:00
  MAE: 89095.6368, RMSE: 91132.4610, MAPE: 16.27%, SMAPE: 17.84%

Processing window 11/11: 2024-02-24 04:00:00 to 2024-02-25 03:00:00
  MAE: 88450.7760, RMSE: 92137.5159, MAPE: 13.68%, SMAPE: 14.84%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 11

Average metrics across all OOD windows:
  MAE:   62404.3314 ± 19709.4013
  RMSE:  71152.0900 ± 19619.6792
  MAPE:  10.34% ± 3.20%
  SMAPE: 11.14% ± 3.68%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Toronto_F2_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Toronto_F2_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Toronto_F2_fold0_summary.txt

✓ patchtst Toronto F2 completed successfully

========================================
Progress: 16/24
Feature Set: F2
========================================
==========================================
Running gru inference for Ottawa - F2
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
==========================================
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/gru_ood_inference.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Ottawa
Feature set: F2, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
Found 13 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/gru_single_train/Ottawa/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F2/97/fold_0/best_model.pth

Processing window 1/13: 2024-01-19 03:00:00 to 2024-01-20 02:00:00
  MAE: 49277.5065, RMSE: 59847.8807, MAPE: 14.22%, SMAPE: 14.33%

Processing window 2/13: 2024-01-10 01:00:00 to 2024-01-11 00:00:00
  MAE: 71071.8006, RMSE: 84927.5193, MAPE: 22.35%, SMAPE: 19.86%

Processing window 3/13: 2023-12-04 03:00:00 to 2023-12-05 02:00:00
  MAE: 50587.3175, RMSE: 59422.3682, MAPE: 16.06%, SMAPE: 15.17%

Processing window 4/13: 2023-11-22 01:00:00 to 2023-11-23 00:00:00
  MAE: 53463.4044, RMSE: 59579.1040, MAPE: 17.84%, SMAPE: 17.05%

Processing window 5/13: 2024-03-09 23:00:00 to 2024-03-10 22:00:00
  MAE: 49624.5749, RMSE: 59223.6752, MAPE: 14.73%, SMAPE: 13.48%

Processing window 6/13: 2023-12-18 09:00:00 to 2023-12-19 08:00:00
  MAE: 61210.1353, RMSE: 75840.5455, MAPE: 19.63%, SMAPE: 17.31%

Processing window 7/13: 2023-10-07 03:00:00 to 2023-10-08 02:00:00
  MAE: 53973.1825, RMSE: 65566.1276, MAPE: 19.85%, SMAPE: 17.42%

Processing window 8/13: 2024-01-13 02:00:00 to 2024-01-14 01:00:00
  MAE: 32689.3995, RMSE: 36378.0396, MAPE: 9.52%, SMAPE: 9.44%

Processing window 9/13: 2024-02-19 09:00:00 to 2024-02-20 08:00:00
  MAE: 87598.8770, RMSE: 105030.1023, MAPE: 24.34%, SMAPE: 20.95%

Processing window 10/13: 2024-01-21 03:00:00 to 2024-01-22 02:00:00
  MAE: 41565.5327, RMSE: 47150.6252, MAPE: 11.18%, SMAPE: 11.16%

Processing window 11/13: 2023-12-10 07:00:00 to 2023-12-11 06:00:00
  MAE: 32025.1897, RMSE: 37508.0641, MAPE: 9.96%, SMAPE: 9.44%

Processing window 12/13: 2023-10-09 07:00:00 to 2023-10-10 06:00:00
  MAE: 19990.7428, RMSE: 24971.7149, MAPE: 8.24%, SMAPE: 8.02%

Processing window 13/13: 2024-02-23 19:00:00 to 2024-02-24 18:00:00
  MAE: 41185.1697, RMSE: 47405.5418, MAPE: 13.10%, SMAPE: 14.31%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 13

Average metrics across all OOD windows:
  MAE:   49558.6795 ± 17516.1080
  RMSE:  58680.8699 ± 21455.5801
  MAPE:  15.46% ± 5.10%
  SMAPE: 14.46% ± 4.07%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Ottawa_F2_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Ottawa_F2_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Ottawa_F2_fold0_summary.txt

✓ gru Ottawa F2 completed successfully

========================================
Progress: 17/24
Feature Set: F2
========================================
==========================================
Running tcn inference for Ottawa - F2
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:143: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/tcn_ood_inference.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Ottawa
Feature set: F2, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
Found 13 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/tcn_single_train/Ottawa/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F2/97/fold_0/best_model.pth

Processing window 1/13: 2024-01-19 03:00:00 to 2024-01-20 02:00:00
  MAE: 28571.4880, RMSE: 33513.6670, MAPE: 8.11%, SMAPE: 8.41%

Processing window 2/13: 2024-01-10 01:00:00 to 2024-01-11 00:00:00
  MAE: 15458.5401, RMSE: 19715.7932, MAPE: 5.45%, SMAPE: 5.24%

Processing window 3/13: 2023-12-04 03:00:00 to 2023-12-05 02:00:00
  MAE: 19469.9259, RMSE: 22793.9991, MAPE: 6.47%, SMAPE: 6.53%

Processing window 4/13: 2023-11-22 01:00:00 to 2023-11-23 00:00:00
  MAE: 15275.8717, RMSE: 20767.6307, MAPE: 5.85%, SMAPE: 5.67%

Processing window 5/13: 2024-03-09 23:00:00 to 2024-03-10 22:00:00
  MAE: 45569.8167, RMSE: 54878.7771, MAPE: 13.74%, SMAPE: 14.66%

Processing window 6/13: 2023-12-18 09:00:00 to 2023-12-19 08:00:00
  MAE: 16629.8495, RMSE: 21048.0361, MAPE: 5.95%, SMAPE: 5.72%

Processing window 7/13: 2023-10-07 03:00:00 to 2023-10-08 02:00:00
  MAE: 20952.1154, RMSE: 26803.3198, MAPE: 7.93%, SMAPE: 7.92%

Processing window 8/13: 2024-01-13 02:00:00 to 2024-01-14 01:00:00
  MAE: 22106.0762, RMSE: 27756.4503, MAPE: 6.69%, SMAPE: 6.68%

Processing window 9/13: 2024-02-19 09:00:00 to 2024-02-20 08:00:00
  MAE: 28653.4690, RMSE: 34211.6604, MAPE: 7.67%, SMAPE: 8.05%

Processing window 10/13: 2024-01-21 03:00:00 to 2024-01-22 02:00:00
  MAE: 31858.2413, RMSE: 36941.9535, MAPE: 8.04%, SMAPE: 8.41%

Processing window 11/13: 2023-12-10 07:00:00 to 2023-12-11 06:00:00
  MAE: 24510.8843, RMSE: 31376.7314, MAPE: 6.88%, SMAPE: 7.15%

Processing window 12/13: 2023-10-09 07:00:00 to 2023-10-10 06:00:00
  MAE: 28020.1309, RMSE: 37207.8950, MAPE: 9.27%, SMAPE: 9.78%

Processing window 13/13: 2024-02-23 19:00:00 to 2024-02-24 18:00:00
  MAE: 39874.9063, RMSE: 45933.4615, MAPE: 11.32%, SMAPE: 12.18%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 13

Average metrics across all OOD windows:
  MAE:   25919.3320 ± 9250.6381
  RMSE:  31765.3366 ± 10419.3614
  MAPE:  7.95% ± 2.35%
  SMAPE: 8.18% ± 2.70%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Ottawa_F2_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Ottawa_F2_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Ottawa_F2_fold0_summary.txt

✓ tcn Ottawa F2 completed successfully

========================================
Progress: 18/24
Feature Set: F2
========================================
==========================================
Running patchtst inference for Ottawa - F2
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/patchtst_ood_inference.py:100: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Ottawa
Feature set: F2, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
Found 13 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/patchtst_single_train/Ottawa/dm64_nh4_nl3_pl16_ps8_inlen168_h24_scalerstandard/overlap/stride1/mean/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F2/597/fold_0/best_model.pth

Processing window 1/13: 2024-01-19 03:00:00 to 2024-01-20 02:00:00
  MAE: 24275.2617, RMSE: 26859.1423, MAPE: 6.71%, SMAPE: 7.01%

Processing window 2/13: 2024-01-10 01:00:00 to 2024-01-11 00:00:00
  MAE: 14167.9741, RMSE: 18200.8652, MAPE: 4.20%, SMAPE: 4.08%

Processing window 3/13: 2023-12-04 03:00:00 to 2023-12-05 02:00:00
  MAE: 9336.9134, RMSE: 12785.1091, MAPE: 3.07%, SMAPE: 3.16%

Processing window 4/13: 2023-11-22 01:00:00 to 2023-11-23 00:00:00
  MAE: 11892.9130, RMSE: 14625.5556, MAPE: 4.00%, SMAPE: 4.10%

Processing window 5/13: 2024-03-09 23:00:00 to 2024-03-10 22:00:00
  MAE: 15254.8253, RMSE: 19344.5369, MAPE: 4.71%, SMAPE: 4.88%

Processing window 6/13: 2023-12-18 09:00:00 to 2023-12-19 08:00:00
  MAE: 6853.9975, RMSE: 11035.0753, MAPE: 2.34%, SMAPE: 2.41%

Processing window 7/13: 2023-10-07 03:00:00 to 2023-10-08 02:00:00
  MAE: 23604.1803, RMSE: 28930.3369, MAPE: 8.54%, SMAPE: 8.16%

Processing window 8/13: 2024-01-13 02:00:00 to 2024-01-14 01:00:00
  MAE: 12796.0070, RMSE: 14374.3409, MAPE: 3.69%, SMAPE: 3.67%

Processing window 9/13: 2024-02-19 09:00:00 to 2024-02-20 08:00:00
  MAE: 13566.1141, RMSE: 15308.4540, MAPE: 3.99%, SMAPE: 4.06%

Processing window 10/13: 2024-01-21 03:00:00 to 2024-01-22 02:00:00
  MAE: 18724.8169, RMSE: 21590.4491, MAPE: 4.95%, SMAPE: 5.14%

Processing window 11/13: 2023-12-10 07:00:00 to 2023-12-11 06:00:00
  MAE: 7790.8915, RMSE: 8938.4704, MAPE: 2.39%, SMAPE: 2.39%

Processing window 12/13: 2023-10-09 07:00:00 to 2023-10-10 06:00:00
  MAE: 14860.4586, RMSE: 17759.1449, MAPE: 5.54%, SMAPE: 5.64%

Processing window 13/13: 2024-02-23 19:00:00 to 2024-02-24 18:00:00
  MAE: 48498.7089, RMSE: 51056.2046, MAPE: 14.48%, SMAPE: 15.81%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 13

Average metrics across all OOD windows:
  MAE:   17047.9279 ± 10837.1332
  RMSE:  20062.1296 ± 10953.6111
  MAPE:  5.28% ± 3.25%
  SMAPE: 5.42% ± 3.54%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Ottawa_F2_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Ottawa_F2_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Ottawa_F2_fold0_summary.txt

✓ patchtst Ottawa F2 completed successfully

========================================
Progress: 19/24
Feature Set: F3
========================================
==========================================
Running gru inference for Toronto - F3
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
==========================================
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/gru_ood_inference.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Toronto
Feature set: F3, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
Found 11 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/gru_single_train/Toronto/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F3/97/fold_0/best_model.pth

Processing window 1/11: 2024-01-20 13:00:00 to 2024-01-21 12:00:00
  MAE: 21909.4188, RMSE: 27545.6872, MAPE: 2.99%, SMAPE: 2.99%

Processing window 2/11: 2024-01-17 10:00:00 to 2024-01-18 09:00:00
  MAE: 17184.7220, RMSE: 20917.3323, MAPE: 2.50%, SMAPE: 2.51%

Processing window 3/11: 2024-01-15 09:00:00 to 2024-01-16 08:00:00
  MAE: 25798.9298, RMSE: 35215.5402, MAPE: 3.94%, SMAPE: 4.05%

Processing window 4/11: 2024-01-10 02:00:00 to 2024-01-11 01:00:00
  MAE: 21512.0308, RMSE: 25867.6459, MAPE: 3.98%, SMAPE: 3.86%

Processing window 5/11: 2024-01-13 03:00:00 to 2024-01-14 02:00:00
  MAE: 20631.5133, RMSE: 26122.4422, MAPE: 3.23%, SMAPE: 3.28%

Processing window 6/11: 2023-11-09 01:00:00 to 2023-11-10 00:00:00
  MAE: 29358.1936, RMSE: 34866.6699, MAPE: 5.45%, SMAPE: 5.27%

Processing window 7/11: 2023-12-10 03:00:00 to 2023-12-11 02:00:00
  MAE: 30386.7269, RMSE: 36324.1729, MAPE: 4.93%, SMAPE: 5.08%

Processing window 8/11: 2023-10-06 01:00:00 to 2023-10-07 00:00:00
  MAE: 31269.3642, RMSE: 35723.0057, MAPE: 6.37%, SMAPE: 6.55%

Processing window 9/11: 2024-01-26 05:00:00 to 2024-01-27 04:00:00
  MAE: 17480.5151, RMSE: 21513.5973, MAPE: 2.83%, SMAPE: 2.83%

Processing window 10/11: 2024-03-09 08:00:00 to 2024-03-10 07:00:00
  MAE: 52695.7788, RMSE: 65240.4317, MAPE: 8.66%, SMAPE: 8.16%

Processing window 11/11: 2024-02-24 04:00:00 to 2024-02-25 03:00:00
  MAE: 45917.1124, RMSE: 50353.5036, MAPE: 7.35%, SMAPE: 7.52%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 11

Average metrics across all OOD windows:
  MAE:   28558.5732 ± 11452.7739
  RMSE:  34517.2753 ± 13221.0938
  MAPE:  4.75% ± 2.02%
  SMAPE: 4.74% ± 1.95%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Toronto_F3_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Toronto_F3_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Toronto_F3_fold0_summary.txt

✓ gru Toronto F3 completed successfully

========================================
Progress: 20/24
Feature Set: F3
========================================
==========================================
Running tcn inference for Toronto - F3
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:143: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/tcn_ood_inference.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Toronto
Feature set: F3, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
Found 11 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/tcn_single_train/Toronto/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F3/97/fold_0/best_model.pth

Processing window 1/11: 2024-01-20 13:00:00 to 2024-01-21 12:00:00
  MAE: 29982.7201, RMSE: 35718.0699, MAPE: 4.15%, SMAPE: 4.22%

Processing window 2/11: 2024-01-17 10:00:00 to 2024-01-18 09:00:00
  MAE: 40804.2942, RMSE: 44241.1697, MAPE: 5.64%, SMAPE: 5.83%

Processing window 3/11: 2024-01-15 09:00:00 to 2024-01-16 08:00:00
  MAE: 25607.2394, RMSE: 30852.6460, MAPE: 3.77%, SMAPE: 3.86%

Processing window 4/11: 2024-01-10 02:00:00 to 2024-01-11 01:00:00
  MAE: 25003.2870, RMSE: 29396.2250, MAPE: 4.26%, SMAPE: 4.34%

Processing window 5/11: 2024-01-13 03:00:00 to 2024-01-14 02:00:00
  MAE: 42875.8662, RMSE: 49008.1787, MAPE: 6.16%, SMAPE: 6.37%

Processing window 6/11: 2023-11-09 01:00:00 to 2023-11-10 00:00:00
  MAE: 30289.4831, RMSE: 37637.4415, MAPE: 5.68%, SMAPE: 5.45%

Processing window 7/11: 2023-12-10 03:00:00 to 2023-12-11 02:00:00
  MAE: 34878.6608, RMSE: 38143.6755, MAPE: 6.05%, SMAPE: 6.09%

Processing window 8/11: 2023-10-06 01:00:00 to 2023-10-07 00:00:00
  MAE: 37309.1538, RMSE: 43833.3102, MAPE: 7.19%, SMAPE: 7.01%

Processing window 9/11: 2024-01-26 05:00:00 to 2024-01-27 04:00:00
  MAE: 18106.8461, RMSE: 22764.8589, MAPE: 3.03%, SMAPE: 3.08%

Processing window 10/11: 2024-03-09 08:00:00 to 2024-03-10 07:00:00
  MAE: 33179.7932, RMSE: 41399.6002, MAPE: 5.60%, SMAPE: 5.83%

Processing window 11/11: 2024-02-24 04:00:00 to 2024-02-25 03:00:00
  MAE: 17767.9874, RMSE: 24202.3152, MAPE: 2.59%, SMAPE: 2.56%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 11

Average metrics across all OOD windows:
  MAE:   30527.7574 ± 8379.7964
  RMSE:  36108.8628 ± 8481.3391
  MAPE:  4.92% ± 1.44%
  SMAPE: 4.97% ± 1.44%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Toronto_F3_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Toronto_F3_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Toronto_F3_fold0_summary.txt

✓ tcn Toronto F3 completed successfully

========================================
Progress: 21/24
Feature Set: F3
========================================
==========================================
Running patchtst inference for Toronto - F3
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/patchtst_ood_inference.py:100: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Toronto
Feature set: F3, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Toronto_val.csv
Found 11 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/patchtst_single_train/Toronto/dm64_nh4_nl3_pl16_ps8_inlen168_h24_scalerstandard/overlap/stride1/mean/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F3/597/fold_0/best_model.pth

Processing window 1/11: 2024-01-20 13:00:00 to 2024-01-21 12:00:00
  MAE: 82045.0570, RMSE: 86514.0584, MAPE: 11.81%, SMAPE: 12.77%

Processing window 2/11: 2024-01-17 10:00:00 to 2024-01-18 09:00:00
  MAE: 57831.1555, RMSE: 72309.4256, MAPE: 9.04%, SMAPE: 9.79%

Processing window 3/11: 2024-01-15 09:00:00 to 2024-01-16 08:00:00
  MAE: 53731.1737, RMSE: 69225.5085, MAPE: 8.61%, SMAPE: 9.31%

Processing window 4/11: 2024-01-10 02:00:00 to 2024-01-11 01:00:00
  MAE: 44112.4660, RMSE: 49965.7757, MAPE: 7.14%, SMAPE: 7.47%

Processing window 5/11: 2024-01-13 03:00:00 to 2024-01-14 02:00:00
  MAE: 74386.4652, RMSE: 87500.9399, MAPE: 10.72%, SMAPE: 11.56%

Processing window 6/11: 2023-11-09 01:00:00 to 2023-11-10 00:00:00
  MAE: 59657.8708, RMSE: 66120.3905, MAPE: 11.33%, SMAPE: 12.18%

Processing window 7/11: 2023-12-10 03:00:00 to 2023-12-11 02:00:00
  MAE: 77098.4094, RMSE: 87108.8750, MAPE: 12.50%, SMAPE: 13.52%

Processing window 8/11: 2023-10-06 01:00:00 to 2023-10-07 00:00:00
  MAE: 44136.2062, RMSE: 53119.5067, MAPE: 9.74%, SMAPE: 10.54%

Processing window 9/11: 2024-01-26 05:00:00 to 2024-01-27 04:00:00
  MAE: 66186.5002, RMSE: 68280.6540, MAPE: 11.44%, SMAPE: 12.20%

Processing window 10/11: 2024-03-09 08:00:00 to 2024-03-10 07:00:00
  MAE: 104940.1189, RMSE: 108451.3720, MAPE: 19.58%, SMAPE: 22.12%

Processing window 11/11: 2024-02-24 04:00:00 to 2024-02-25 03:00:00
  MAE: 124909.3250, RMSE: 130071.4771, MAPE: 19.03%, SMAPE: 21.23%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 11

Average metrics across all OOD windows:
  MAE:   71730.4316 ± 25081.8213
  RMSE:  79878.9076 ± 23654.8981
  MAPE:  11.90% ± 3.98%
  SMAPE: 12.97% ± 4.64%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Toronto_F3_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Toronto_F3_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Toronto_F3_fold0_summary.txt

✓ patchtst Toronto F3 completed successfully

========================================
Progress: 22/24
Feature Set: F3
========================================
==========================================
Running gru inference for Ottawa - F3
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
==========================================
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/gru_ood_inference.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Ottawa
Feature set: F3, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
Found 13 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/gru_single_train/Ottawa/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F3/97/fold_0/best_model.pth

Processing window 1/13: 2024-01-19 03:00:00 to 2024-01-20 02:00:00
  MAE: 73390.2168, RMSE: 100387.9805, MAPE: 20.15%, SMAPE: 17.08%

Processing window 2/13: 2024-01-10 01:00:00 to 2024-01-11 00:00:00
  MAE: 74817.3546, RMSE: 94180.3545, MAPE: 23.06%, SMAPE: 19.55%

Processing window 3/13: 2023-12-04 03:00:00 to 2023-12-05 02:00:00
  MAE: 78042.4816, RMSE: 99469.8491, MAPE: 23.78%, SMAPE: 20.07%

Processing window 4/13: 2023-11-22 01:00:00 to 2023-11-23 00:00:00
  MAE: 48871.5188, RMSE: 60132.9558, MAPE: 15.45%, SMAPE: 13.98%

Processing window 5/13: 2024-03-09 23:00:00 to 2024-03-10 22:00:00
  MAE: 95421.6226, RMSE: 101634.3246, MAPE: 34.05%, SMAPE: 28.30%

Processing window 6/13: 2023-12-18 09:00:00 to 2023-12-19 08:00:00
  MAE: 77707.9340, RMSE: 99141.2296, MAPE: 24.47%, SMAPE: 20.53%

Processing window 7/13: 2023-10-07 03:00:00 to 2023-10-08 02:00:00
  MAE: 93764.0546, RMSE: 101414.4541, MAPE: 34.86%, SMAPE: 29.43%

Processing window 8/13: 2024-01-13 02:00:00 to 2024-01-14 01:00:00
  MAE: 78395.0605, RMSE: 88655.3168, MAPE: 22.35%, SMAPE: 19.70%

Processing window 9/13: 2024-02-19 09:00:00 to 2024-02-20 08:00:00
  MAE: 114067.9745, RMSE: 133018.5690, MAPE: 31.26%, SMAPE: 26.07%

Processing window 10/13: 2024-01-21 03:00:00 to 2024-01-22 02:00:00
  MAE: 77840.5495, RMSE: 95982.8132, MAPE: 20.56%, SMAPE: 17.91%

Processing window 11/13: 2023-12-10 07:00:00 to 2023-12-11 06:00:00
  MAE: 94131.5669, RMSE: 105853.5135, MAPE: 27.64%, SMAPE: 23.85%

Processing window 12/13: 2023-10-09 07:00:00 to 2023-10-10 06:00:00
  MAE: 76896.8834, RMSE: 82578.1522, MAPE: 27.05%, SMAPE: 23.58%

Processing window 13/13: 2024-02-23 19:00:00 to 2024-02-24 18:00:00
  MAE: 40160.9241, RMSE: 44833.4614, MAPE: 11.81%, SMAPE: 11.17%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 13

Average metrics across all OOD windows:
  MAE:   78731.3955 ± 19190.5343
  RMSE:  92867.9211 ± 21571.6288
  MAPE:  24.35% ± 6.74%
  SMAPE: 20.86% ± 5.32%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Ottawa_F3_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Ottawa_F3_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/gru/Ottawa_F3_fold0_summary.txt

✓ gru Ottawa F3 completed successfully

========================================
Progress: 23/24
Feature Set: F3
========================================
==========================================
Running tcn inference for Ottawa - F3
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:143: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/tcn_ood_inference.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Ottawa
Feature set: F3, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
Found 13 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/tcn_single_train/Ottawa/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F3/97/fold_0/best_model.pth

Processing window 1/13: 2024-01-19 03:00:00 to 2024-01-20 02:00:00
  MAE: 45334.5059, RMSE: 52535.2270, MAPE: 11.85%, SMAPE: 12.80%

Processing window 2/13: 2024-01-10 01:00:00 to 2024-01-11 00:00:00
  MAE: 22076.9007, RMSE: 28590.2947, MAPE: 6.77%, SMAPE: 6.95%

Processing window 3/13: 2023-12-04 03:00:00 to 2023-12-05 02:00:00
  MAE: 24262.5647, RMSE: 29287.1706, MAPE: 8.03%, SMAPE: 7.95%

Processing window 4/13: 2023-11-22 01:00:00 to 2023-11-23 00:00:00
  MAE: 20780.5958, RMSE: 24865.3912, MAPE: 7.42%, SMAPE: 7.30%

Processing window 5/13: 2024-03-09 23:00:00 to 2024-03-10 22:00:00
  MAE: 36094.3231, RMSE: 40243.4599, MAPE: 11.81%, SMAPE: 11.85%

Processing window 6/13: 2023-12-18 09:00:00 to 2023-12-19 08:00:00
  MAE: 31543.9016, RMSE: 38399.9933, MAPE: 10.89%, SMAPE: 10.21%

Processing window 7/13: 2023-10-07 03:00:00 to 2023-10-08 02:00:00
  MAE: 14266.8545, RMSE: 18297.7664, MAPE: 6.30%, SMAPE: 5.95%

Processing window 8/13: 2024-01-13 02:00:00 to 2024-01-14 01:00:00
  MAE: 32988.1130, RMSE: 40736.7729, MAPE: 8.73%, SMAPE: 9.15%

Processing window 9/13: 2024-02-19 09:00:00 to 2024-02-20 08:00:00
  MAE: 22563.1346, RMSE: 27403.9151, MAPE: 6.24%, SMAPE: 6.49%

Processing window 10/13: 2024-01-21 03:00:00 to 2024-01-22 02:00:00
  MAE: 55596.7288, RMSE: 68628.9577, MAPE: 13.11%, SMAPE: 14.33%

Processing window 11/13: 2023-12-10 07:00:00 to 2023-12-11 06:00:00
  MAE: 24432.4732, RMSE: 27798.8146, MAPE: 7.45%, SMAPE: 7.46%

Processing window 12/13: 2023-10-09 07:00:00 to 2023-10-10 06:00:00
  MAE: 20708.8807, RMSE: 24485.7312, MAPE: 8.10%, SMAPE: 7.66%

Processing window 13/13: 2024-02-23 19:00:00 to 2024-02-24 18:00:00
  MAE: 34007.4832, RMSE: 40203.6081, MAPE: 9.65%, SMAPE: 10.31%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 13

Average metrics across all OOD windows:
  MAE:   29588.9584 ± 11378.0069
  RMSE:  35498.2387 ± 13569.9080
  MAPE:  8.95% ± 2.30%
  SMAPE: 9.11% ± 2.61%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Ottawa_F3_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Ottawa_F3_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/tcn/Ottawa_F3_fold0_summary.txt

✓ tcn Ottawa F3 completed successfully

========================================
Progress: 24/24
Feature Set: F3
========================================
==========================================
Running patchtst inference for Ottawa - F3
OOD file: /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
==========================================
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
/usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/exps/ood_inference/patchtst_ood_inference.py:100: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
/usr/local/data/elisejzh/miniconda3/envs/scratch/lib/python3.10/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but StandardScaler was fitted without feature names
  warnings.warn(
Starting OOD inference for Ottawa
Feature set: F3, Fold: 0
Loading data...
Loading OOD windows from /home/automation/elisejzh/Desktop/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_analysis/ood_windows_Ottawa_val.csv
Found 13 OOD windows
Loading model from /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/forecast1111/per_region/patchtst_single_train/Ottawa/dm64_nh4_nl3_pl16_ps8_inlen168_h24_scalerstandard/overlap/stride1/mean/bs64_ep500_lr0.0001_tr0.93_vr0.07_pat20_esep0.0001/F3/597/fold_0/best_model.pth

Processing window 1/13: 2024-01-19 03:00:00 to 2024-01-20 02:00:00
  MAE: 59376.6525, RMSE: 61483.9024, MAPE: 16.35%, SMAPE: 17.90%

Processing window 2/13: 2024-01-10 01:00:00 to 2024-01-11 00:00:00
  MAE: 10719.8588, RMSE: 12437.7861, MAPE: 3.48%, SMAPE: 3.54%

Processing window 3/13: 2023-12-04 03:00:00 to 2023-12-05 02:00:00
  MAE: 43536.0024, RMSE: 45306.4489, MAPE: 14.30%, SMAPE: 15.53%

Processing window 4/13: 2023-11-22 01:00:00 to 2023-11-23 00:00:00
  MAE: 37008.2915, RMSE: 41248.1077, MAPE: 12.16%, SMAPE: 13.15%

Processing window 5/13: 2024-03-09 23:00:00 to 2024-03-10 22:00:00
  MAE: 45192.6470, RMSE: 48898.7176, MAPE: 14.25%, SMAPE: 15.46%

Processing window 6/13: 2023-12-18 09:00:00 to 2023-12-19 08:00:00
  MAE: 31797.1366, RMSE: 33312.4526, MAPE: 10.93%, SMAPE: 11.66%

Processing window 7/13: 2023-10-07 03:00:00 to 2023-10-08 02:00:00
  MAE: 14232.8425, RMSE: 16103.6468, MAPE: 6.32%, SMAPE: 6.60%

Processing window 8/13: 2024-01-13 02:00:00 to 2024-01-14 01:00:00
  MAE: 27627.1256, RMSE: 30842.3657, MAPE: 7.90%, SMAPE: 8.29%

Processing window 9/13: 2024-02-19 09:00:00 to 2024-02-20 08:00:00
  MAE: 36397.2433, RMSE: 41799.4138, MAPE: 10.99%, SMAPE: 11.91%

Processing window 10/13: 2024-01-21 03:00:00 to 2024-01-22 02:00:00
  MAE: 46095.1164, RMSE: 47903.5214, MAPE: 12.09%, SMAPE: 12.95%

Processing window 11/13: 2023-12-10 07:00:00 to 2023-12-11 06:00:00
  MAE: 30485.8157, RMSE: 33125.0660, MAPE: 9.22%, SMAPE: 9.74%

Processing window 12/13: 2023-10-09 07:00:00 to 2023-10-10 06:00:00
  MAE: 21571.2441, RMSE: 24798.4283, MAPE: 9.07%, SMAPE: 9.74%

Processing window 13/13: 2024-02-23 19:00:00 to 2024-02-24 18:00:00
  MAE: 63355.9875, RMSE: 67980.4671, MAPE: 18.56%, SMAPE: 20.78%

============================================================
Summary Statistics
============================================================
Total OOD windows processed: 13

Average metrics across all OOD windows:
  MAE:   35953.5357 ± 15754.4459
  RMSE:  38864.6403 ± 16176.0196
  MAPE:  11.20% ± 4.12%
  SMAPE: 12.10% ± 4.68%

Results saved to:
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Ottawa_F3_fold0_ood_metrics.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Ottawa_F3_fold0_ood_predictions.csv
  - /usr/local/data/elisejzh/Projects/Mine/Causal_Electricity_Consumption_Forecast/outputs/ood_inference/patchtst/Ottawa_F3_fold0_summary.txt

✓ patchtst Ottawa F3 completed successfully

==========================================
All OOD inference runs completed!
==========================================

Results saved in:
  - outputs/ood_inference/{model}/{Region}_{FeatureSet}_fold0_*

Next steps:
  1. Generate comparison reports for each feature set:
     python exps/ood_inference/compare_ood_normal.py --regions Toronto Ottawa --models gru tcn patchtst --feature_set F0 --fold 0
     python exps/ood_inference/compare_ood_normal.py --regions Toronto Ottawa --models gru tcn patchtst --feature_set F1 --fold 0
     python exps/ood_inference/compare_ood_normal.py --regions Toronto Ottawa --models gru tcn patchtst --feature_set F3 --fold 0

  2. Compare feature sets:
     python exps/ood_inference/compare_feature_sets.py

